# AWS 初期設定

## 料金アラートを設定

- AWS の利用料金が設定額を超えたら通知する
- 請求ダッシュボードで請求アラートを受け取る
- CloudWatch で料金アラートを設定

### 請求ダッシュボードで請求アラートを受け取るように設定

| 画面                                               |
| -------------------------------------------------- |
| アカウント名/マイ請求ダッシュボード/Billing の設定 |

- `電子メールで PDF 版請求書を受け取る`にチェック
- `無料利用枠の使用のアラートの受信`にチェック(1 年間の無料枠を超えそうになったらアラート)。E メールアドレスを入力
- `請求アラートを受け取る`にチェック。CloudWatch で料金アラートを設定することができる
- `請求アラートを管理する`を押下

### CloudWatch で料金アラートを設定

| 画面                     | 押下           |
| ------------------------ | -------------- |
| サービス/CloudWatch/請求 | アラームの作成 |

- 請求アラームで超過の額を設定(例 10USD)
- `通知の連絡先`を入力

## IAM の作業用ユーザーとは

- AWS アカウントを作成するとルートユーザーが作成される
- ルートユーザーは通常使用せず、作業用の IAM ユーザーを作成して使用するのがベストプラクティス

### ルートユーザーとは

- 全ての AWS サービスと AWS リソースのアクセス権を持つユーザー
- アカウントの変更、解約、サポートプランの変更等のアクションのときのみに使用
- 極力ルートユーザーは使用しない

### IAM ユーザーとは

- AWS で作成するユーザー
- 認証情報とアクセス許可の権限を個別に設定できる
- 作業者ごとに個別作成
- 通常の作業は IAM ユーザーで行う
- エンジニア、ディレクターによって権限を分ける

### ルートユーザーでの作業

| 画面                                                         | 押下 |
| ------------------------------------------------------------ | ---- |
| マイアカウント/IAM ユーザー/ロールによる請求情報へのアクセス | 編集 |

- IAM アクセスのアクティブ化(IAM ユーザーで請求情報が閲覧できる)

### IAM ユーザーの設定

| 画面                  | 押下           |
| --------------------- | -------------- |
| サービス/IAM/ユーザー | ユーザーを追加 |

- アクセスの種類`AWS マネジメントコンソールへのアクセス`にチェック
- `パスワードのリセットが必要`で他の作業者用のユーザー作成のとき自動生成パスワードが生成される
- `既存のポリシーを直接アタッチ`とは AWS が定めたデフォルトの権限
- `AdministratorAccess`とはほとんどのサービスにアクセスできる権限
- `タグの追加`でそのユーザーがどういう役割かを入力

## 操作ログを記録とは

- いつ誰が何をしたのかを記録しておく
- 不正アクセスや不正操作があったときにチェックできるようにする
- CloudTrail で証跡を作成
- S3 にログが保存される

### CloudTrail とは

- AWS ユーザーの操作を記録するサービス
- 操作ログを S3 に保存(永久に保存できる)
- CloudTrail は無料。S3 は従量課金制

### CloudTrail の設定

| 画面                | 押下       |
| ------------------- | ---------- |
| サービス/CloudTrail | 証跡の作成 |

- データイベント
  - S3
    - `アカウントのすべての S3 バケットの選択`にチェック
- ストレージの場所
  - `新しいS3 バケットを作成しますか`で「はい」を選択
  - `S3バケット`を入力

### アカウント登録後にすること

- ルートアカウントの利用を停止
- 多要素認証を有効化
- AWS Cloud Trail を有効化
- AWS の請求レポートを有効化
