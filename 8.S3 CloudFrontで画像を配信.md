# 【S3】CloudFrontで画像を配信

## インフラ設計における重要な観点

- 可用性
 - サービスを継続的に利用できるか
 - 稼働率、目標復旧時間、災害対策
- 性能・拡張性
 - システムの性能が充分で将来的においても拡張しやすいか
 - 性能目標、拡張性
- 運用・保守性
 - 運用時間、バックアップ、運用監視、定期メンテナンス
- セキュリティ
 - 情報が安全に守られているか
 - 資産の公開範囲、ガイドライン、情報漏えい問題
- 移行性
 - 現行システムを他のシステムに移行しやすくなっているか
 - 移行方式の規定、設備・データ、移行スケジュール

## 画像の保存場所をWebサーバーではなくS3にする理由

- Webサーバーのストレージが画像でいっぱいになるのを防ぐ
- HTMLへのアクセス(Webサーバー)と画像へのアクセス(S3)を分けることで負荷分散する
- サーバーの台数を増やしやすくする
 - Webサーバー上に画像が保存されているとWebサーバーの台数を増やしたいときに画像を同期する必要がある。スケールアウトが難しい。
 - 画像の保存場所が分けられている方がWebサーバーの台数を簡単に増やすことができる
- コンテンツ配信サービスから配信することで画像配信を高速化できる

## S3とは

- 安価で耐久性の高いAWSのクラウドストレージサービス
- 1GB 約3円/月
- 容量無制限
- 1ファイル最大5TBまで
- バケットやオブジェクトに対してアクセス制限を設定できる

### バケットとは

- オブジェクト(ファイル)を保存する場所
- 名前はグローバルで一意にする

### オブジェクトとは

- データ本体。S3に格納されるファイルのことを指す
- URLが付与される
- バケット内のオブジェクト数は無制限

### キーとは

- オブジェクトの格納URL
- オブジェクトが保存されるとキーが割り当てられる

## S3利用シーン

- 静的コンテンツの配信
 - img画像はS3から配信する
- バッチ連携用のファイル置き場
 - S3にファイルを置いて、バッチでそのファイルを参照して処理を実行
- ログの出力先を指定
 - 操作ログ、サーバーへのアクセスログなどを定期的に送る
- 静的Webホスティング
 - 静的なWebサイト(LP)をS3から公開する
